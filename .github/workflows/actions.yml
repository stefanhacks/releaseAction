name: Release Action

on:
  push:
    tags:
      - 'v[0-9]+.[0-9]+.[0-9]+'

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        include:
          - os: ubuntu-latest
            asset_name_suffix: ''
            asset_content_type: application/octet-stream
          - os: windows-latest
            asset_name_suffix: .exe
            asset_content_type: application/octet-stream
          - os: macOS-latest
            asset_name_suffix: ''
            asset_content_type: application/octet-stream
    steps:
    - uses: actions/checkout@v1
    - uses: tubone24/setup-nim-action@v1.0.1
    - name: Install Dependencies
      run: nimble install -d --accept
    - name: Build
      run: nimble build -d:release
    - name: get version
      id: get_version
      run: |
        echo ::set-output name=VERSION::${GITHUB_REF/refs\/tags\//}
    - uses: ncipollo/release-action@v1
      with:
        token: ${{ secrets.GITHUB_TOKEN }} 
        generateReleaseNotes: true
    - name: update release
      id: update_release
      uses: tubone24/update_release@v1.0
      env:
        GITHUB_TOKEN: ${{ github.token }}
      with:
        body: '
## Changelog


**Sanity Testing Required**: 

Describe tests that should be performed, based on the new features and fixes that are not included on [Whiteglove](https://www.notion.so/playcoinc/Test-Plan-15457d2a923f4f47ae7045b9643665cf)

* Test tutorial flow with bucket A. It should complete and display ABC

* Test tutorial flow with bucket B. It should skip X and then display DEF

## Release Info

**Release Owner**: 


**Release Type**:

- [ ] Hotfix

- [ ] Minor (_Requires PO/Manager sign-off_)

- [ ] Major (_Requires Customer Support and PO/Manager sign-off_)


**Risk Level and potential Risks**:


## Sign-off

**Smoke Test / Whiteglove**:

**Final Approval**:

**Rollout Date**:'
